---
name: Lint

on:
  push:
    branches: [main]
  pull_request:

jobs:
  shellcheck:
    name: ShellCheck
    runs-on: ubuntu-24.04
    steps:
      - uses: actions/checkout@v4
      - uses: ludeeus/action-shellcheck@2.0.0
        env:
          SHELLCHECK_OPTS: "--shell=bash --external-sources"
        with:
          ignore_paths: dot_zsh

  yamllint:
    name: yamllint
    runs-on: ubuntu-24.04
    steps:
      - uses: actions/checkout@v4
      - uses: ibiqlik/action-yamllint@v3

  markdownlint:
    name: markdownlint
    runs-on: ubuntu-24.04
    steps:
      - uses: actions/checkout@v4
      - uses: DavidAnson/markdownlint-cli2-action@v19

  secretlint:
    name: secretlint
    runs-on: ubuntu-24.04
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: "22"
      - run: npm install --no-save secretlint @secretlint/secretlint-rule-preset-recommend
      - run: npx secretlint "**/*"

  zsh-syntax:
    name: zsh syntax check
    runs-on: ubuntu-24.04
    steps:
      - uses: actions/checkout@v4
      - run: |
          status=0
          while IFS= read -r -d '' f; do
            zsh -n "$f" || status=1
          done < <(find dot_zsh -name '*.zsh' -print0)
          exit "$status"

  actionlint:
    name: actionlint
    runs-on: ubuntu-24.04
    steps:
      - uses: actions/checkout@v4
      - uses: raven-actions/actionlint@v2
