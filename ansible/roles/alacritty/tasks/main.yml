---
- name: "Install Alacritty (Ubuntu)"
  block:
    - name: "Clone alacritty"
      git:
        repo: "https://github.com/alacritty/alacritty.git"
        dest: "/tmp/alacritty"
        update: true
    # https://github.com/alacritty/alacritty/blob/master/INSTALL.md#debianubuntu
    - name: "Add dependencies"
      become: true
      apt:
        name:
          - cmake
          - pkg-config
          - libfreetype6-dev
          - libfontconfig1-dev
          - libxcb-xfixes0-dev
          - libxkbcommon-dev
          - python3
        state: latest
        update_cache: true
    - name: "Build alacritty"
      command: "cargo build --release"
      args:
        chdir: "/tmp/alacritty"
    - name: "Move alacritty to /usr/local/bin"
      become: true
      copy:
        src: "/tmp/alacritty/target/release/alacritty"
        dest: "/usr/local/bin"
        mode: "0755"
  when:
    - ansible_facts['distribution'] == 'Ubuntu'
